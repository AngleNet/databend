---------- Input ----------
show tables;
---------- Output ---------
SHOW TABLES
---------- AST ------------
ShowTables


---------- Input ----------
show processlist;
---------- Output ---------
SHOW PROCESSLIST
---------- AST ------------
ShowProcessList


---------- Input ----------
show create table a.b;
---------- Output ---------
SHOW CREATE TABLE a.b
---------- AST ------------
ShowCreateTable {
    database: Some(
        Identifier {
            name: "a",
            quote: None,
        },
    ),
    table: Identifier {
        name: "b",
        quote: None,
    },
}


---------- Input ----------
explain analyze select a from b;
---------- Output ---------
EXPLAIN ANALYZE SELECT a FROM b
---------- AST ------------
Explain {
    analyze: true,
    query: Select(
        Query {
            body: Select(
                SelectStmt {
                    distinct: false,
                    select_list: [
                        AliasedExpr {
                            expr: ColumnRef {
                                database: None,
                                table: None,
                                column: Identifier {
                                    name: "a",
                                    quote: None,
                                },
                            },
                            alias: None,
                        },
                    ],
                    from: Table {
                        database: None,
                        table: Identifier {
                            name: "b",
                            quote: None,
                        },
                        alias: None,
                    },
                    selection: None,
                    group_by: [],
                    having: None,
                },
            ),
            order_by: [],
            limit: [],
        },
    ),
}


---------- Input ----------
describe a;
---------- Output ---------
DESCRIBE a
---------- AST ------------
Describe {
    database: None,
    table: Identifier {
        name: "a",
        quote: None,
    },
}


---------- Input ----------
create table if not exists a.b (c integer not null default 1, b varchar);
---------- Output ---------
CREATE TABLE IF NOT EXISTS a.b (c INTEGER NOT NULL DEFAULT 1, b VARCHAR NULL)
---------- AST ------------
CreateTable {
    if_not_exists: true,
    database: Some(
        Identifier {
            name: "a",
            quote: None,
        },
    ),
    table: Identifier {
        name: "b",
        quote: None,
    },
    columns: [
        ColumnDefinition {
            name: Identifier {
                name: "c",
                quote: None,
            },
            data_type: Int {
                unsigned: false,
            },
            nullable: false,
            default_value: Some(
                Number(
                    "1",
                ),
            ),
        },
        ColumnDefinition {
            name: Identifier {
                name: "b",
                quote: None,
            },
            data_type: Varchar,
            nullable: true,
            default_value: None,
        },
    ],
    engine: "",
    options: [],
    like_db: None,
    like_table: None,
}


---------- Input ----------
create table if not exists a.b (c integer default 1 not null, b varchar);
---------- Output ---------
CREATE TABLE IF NOT EXISTS a.b (c INTEGER NOT NULL DEFAULT 1, b VARCHAR NULL)
---------- AST ------------
CreateTable {
    if_not_exists: true,
    database: Some(
        Identifier {
            name: "a",
            quote: None,
        },
    ),
    table: Identifier {
        name: "b",
        quote: None,
    },
    columns: [
        ColumnDefinition {
            name: Identifier {
                name: "c",
                quote: None,
            },
            data_type: Int {
                unsigned: false,
            },
            nullable: false,
            default_value: Some(
                Number(
                    "1",
                ),
            ),
        },
        ColumnDefinition {
            name: Identifier {
                name: "b",
                quote: None,
            },
            data_type: Varchar,
            nullable: true,
            default_value: None,
        },
    ],
    engine: "",
    options: [],
    like_db: None,
    like_table: None,
}


---------- Input ----------
create table a.b like c.d;
---------- Output ---------
CREATE TABLE a.b ()
---------- AST ------------
CreateTable {
    if_not_exists: false,
    database: Some(
        Identifier {
            name: "a",
            quote: None,
        },
    ),
    table: Identifier {
        name: "b",
        quote: None,
    },
    columns: [],
    engine: "",
    options: [],
    like_db: Some(
        Identifier {
            name: "c",
            quote: None,
        },
    ),
    like_table: Some(
        Identifier {
            name: "d",
            quote: None,
        },
    ),
}


---------- Input ----------
truncate table a;
---------- Output ---------
TRUNCATE TABLE a
---------- AST ------------
TruncateTable {
    database: None,
    table: Identifier {
        name: "a",
        quote: None,
    },
}


---------- Input ----------
truncate table "a".b;
---------- Output ---------
TRUNCATE TABLE "a".b
---------- AST ------------
TruncateTable {
    database: Some(
        Identifier {
            name: "a",
            quote: Some(
                '"',
            ),
        },
    ),
    table: Identifier {
        name: "b",
        quote: None,
    },
}


---------- Input ----------
drop table a;
---------- Output ---------
DROP TABLE a
---------- AST ------------
DropTable {
    if_exists: false,
    database: None,
    table: Identifier {
        name: "a",
        quote: None,
    },
}


---------- Input ----------
drop table if exists a."b";
---------- Output ---------
DROP TABLE IF EXISTS a."b"
---------- AST ------------
DropTable {
    if_exists: true,
    database: Some(
        Identifier {
            name: "a",
            quote: None,
        },
    ),
    table: Identifier {
        name: "b",
        quote: Some(
            '"',
        ),
    },
}


---------- Input ----------
use "a";
---------- Output ---------
USE "a"
---------- AST ------------
UseDatabase {
    name: Identifier {
        name: "a",
        quote: Some(
            '"',
        ),
    },
}


---------- Input ----------
create database if not exists a;
---------- Output ---------
CREATE DATABASE IF NOT EXISTS a
---------- AST ------------
CreateDatabase {
    if_not_exists: true,
    name: Identifier {
        name: "a",
        quote: None,
    },
    engine: "",
    options: [],
}


---------- Input ----------
create table c(a DateTime null, b DateTime(3));
---------- Output ---------
CREATE TABLE c (a DATETIME NULL, b DATETIME(3) NULL)
---------- AST ------------
CreateTable {
    if_not_exists: false,
    database: None,
    table: Identifier {
        name: "c",
        quote: None,
    },
    columns: [
        ColumnDefinition {
            name: Identifier {
                name: "a",
                quote: None,
            },
            data_type: DateTime {
                precision: None,
            },
            nullable: true,
            default_value: None,
        },
        ColumnDefinition {
            name: Identifier {
                name: "b",
                quote: None,
            },
            data_type: DateTime {
                precision: Some(
                    3,
                ),
            },
            nullable: true,
            default_value: None,
        },
    ],
    engine: "",
    options: [],
    like_db: None,
    like_table: None,
}


---------- Input ----------
truncate table test;
---------- Output ---------
TRUNCATE TABLE test
---------- AST ------------
TruncateTable {
    database: None,
    table: Identifier {
        name: "test",
        quote: None,
    },
}


---------- Input ----------
truncate table test_db.test;
---------- Output ---------
TRUNCATE TABLE test_db.test
---------- AST ------------
TruncateTable {
    database: Some(
        Identifier {
            name: "test_db",
            quote: None,
        },
    ),
    table: Identifier {
        name: "test",
        quote: None,
    },
}


---------- Input ----------
DROP table table1;
---------- Output ---------
DROP TABLE table1
---------- AST ------------
DropTable {
    if_exists: false,
    database: None,
    table: Identifier {
        name: "table1",
        quote: None,
    },
}


---------- Input ----------
DROP table IF EXISTS table1;
---------- Output ---------
DROP TABLE IF EXISTS table1
---------- AST ------------
DropTable {
    if_exists: true,
    database: None,
    table: Identifier {
        name: "table1",
        quote: None,
    },
}


---------- Input ----------
CREATE TABLE t(c1 int null, c2 bigint null, c3 varchar null);
---------- Output ---------
CREATE TABLE t (c1 INTEGER NULL, c2 BIGINT NULL, c3 VARCHAR NULL)
---------- AST ------------
CreateTable {
    if_not_exists: false,
    database: None,
    table: Identifier {
        name: "t",
        quote: None,
    },
    columns: [
        ColumnDefinition {
            name: Identifier {
                name: "c1",
                quote: None,
            },
            data_type: Int {
                unsigned: false,
            },
            nullable: true,
            default_value: None,
        },
        ColumnDefinition {
            name: Identifier {
                name: "c2",
                quote: None,
            },
            data_type: BigInt {
                unsigned: false,
            },
            nullable: true,
            default_value: None,
        },
        ColumnDefinition {
            name: Identifier {
                name: "c3",
                quote: None,
            },
            data_type: Varchar,
            nullable: true,
            default_value: None,
        },
    ],
    engine: "",
    options: [],
    like_db: None,
    like_table: None,
}


---------- Input ----------
CREATE TABLE t(c1 int not null, c2 bigint not null, c3 varchar not null);
---------- Output ---------
CREATE TABLE t (c1 INTEGER NOT NULL, c2 BIGINT NOT NULL, c3 VARCHAR NOT NULL)
---------- AST ------------
CreateTable {
    if_not_exists: false,
    database: None,
    table: Identifier {
        name: "t",
        quote: None,
    },
    columns: [
        ColumnDefinition {
            name: Identifier {
                name: "c1",
                quote: None,
            },
            data_type: Int {
                unsigned: false,
            },
            nullable: false,
            default_value: None,
        },
        ColumnDefinition {
            name: Identifier {
                name: "c2",
                quote: None,
            },
            data_type: BigInt {
                unsigned: false,
            },
            nullable: false,
            default_value: None,
        },
        ColumnDefinition {
            name: Identifier {
                name: "c3",
                quote: None,
            },
            data_type: Varchar,
            nullable: false,
            default_value: None,
        },
    ],
    engine: "",
    options: [],
    like_db: None,
    like_table: None,
}


---------- Input ----------
CREATE TABLE t(c1 int default 1);
---------- Output ---------
CREATE TABLE t (c1 INTEGER NULL DEFAULT 1)
---------- AST ------------
CreateTable {
    if_not_exists: false,
    database: None,
    table: Identifier {
        name: "t",
        quote: None,
    },
    columns: [
        ColumnDefinition {
            name: Identifier {
                name: "c1",
                quote: None,
            },
            data_type: Int {
                unsigned: false,
            },
            nullable: true,
            default_value: Some(
                Number(
                    "1",
                ),
            ),
        },
    ],
    engine: "",
    options: [],
    like_db: None,
    like_table: None,
}


---------- Input ----------
select distinct a, count(*) from t where a = 1 and b - 1 < a group by a having a = 1;
---------- Output ---------
SELECT DISTINCT a, COUNT(*) FROM t WHERE a = 1 AND b - 1 < a GROUP BY a HAVING a = 1
---------- AST ------------
Select(
    Query {
        body: Select(
            SelectStmt {
                distinct: true,
                select_list: [
                    AliasedExpr {
                        expr: ColumnRef {
                            database: None,
                            table: None,
                            column: Identifier {
                                name: "a",
                                quote: None,
                            },
                        },
                        alias: None,
                    },
                    AliasedExpr {
                        expr: CountAll,
                        alias: None,
                    },
                ],
                from: Table {
                    database: None,
                    table: Identifier {
                        name: "t",
                        quote: None,
                    },
                    alias: None,
                },
                selection: Some(
                    BinaryOp {
                        op: And,
                        left: BinaryOp {
                            op: Eq,
                            left: ColumnRef {
                                database: None,
                                table: None,
                                column: Identifier {
                                    name: "a",
                                    quote: None,
                                },
                            },
                            right: Literal(
                                Number(
                                    "1",
                                ),
                            ),
                        },
                        right: BinaryOp {
                            op: Lt,
                            left: BinaryOp {
                                op: Minus,
                                left: ColumnRef {
                                    database: None,
                                    table: None,
                                    column: Identifier {
                                        name: "b",
                                        quote: None,
                                    },
                                },
                                right: Literal(
                                    Number(
                                        "1",
                                    ),
                                ),
                            },
                            right: ColumnRef {
                                database: None,
                                table: None,
                                column: Identifier {
                                    name: "a",
                                    quote: None,
                                },
                            },
                        },
                    },
                ),
                group_by: [
                    ColumnRef {
                        database: None,
                        table: None,
                        column: Identifier {
                            name: "a",
                            quote: None,
                        },
                    },
                ],
                having: Some(
                    BinaryOp {
                        op: Eq,
                        left: ColumnRef {
                            database: None,
                            table: None,
                            column: Identifier {
                                name: "a",
                                quote: None,
                            },
                        },
                        right: Literal(
                            Number(
                                "1",
                            ),
                        ),
                    },
                ),
            },
        ),
        order_by: [],
        limit: [],
    },
)


---------- Input ----------
select * from a, b, c;
---------- Output ---------
SELECT * FROM a CROSS JOIN b CROSS JOIN c
---------- AST ------------
Select(
    Query {
        body: Select(
            SelectStmt {
                distinct: false,
                select_list: [
                    QualifiedName(
                        [
                            Star,
                        ],
                    ),
                ],
                from: Join(
                    Join {
                        op: CrossJoin,
                        condition: None,
                        left: Join(
                            Join {
                                op: CrossJoin,
                                condition: None,
                                left: Table {
                                    database: None,
                                    table: Identifier {
                                        name: "a",
                                        quote: None,
                                    },
                                    alias: None,
                                },
                                right: Table {
                                    database: None,
                                    table: Identifier {
                                        name: "b",
                                        quote: None,
                                    },
                                    alias: None,
                                },
                            },
                        ),
                        right: Table {
                            database: None,
                            table: Identifier {
                                name: "c",
                                quote: None,
                            },
                            alias: None,
                        },
                    },
                ),
                selection: None,
                group_by: [],
                having: None,
            },
        ),
        order_by: [],
        limit: [],
    },
)


---------- Input ----------
select * from a join b on a.a = b.a;
---------- Output ---------
SELECT * FROM a INNER JOIN b ON a.a = b.a
---------- AST ------------
Select(
    Query {
        body: Select(
            SelectStmt {
                distinct: false,
                select_list: [
                    QualifiedName(
                        [
                            Star,
                        ],
                    ),
                ],
                from: Join(
                    Join {
                        op: Inner,
                        condition: On(
                            BinaryOp {
                                op: Eq,
                                left: ColumnRef {
                                    database: None,
                                    table: Some(
                                        Identifier {
                                            name: "a",
                                            quote: None,
                                        },
                                    ),
                                    column: Identifier {
                                        name: "a",
                                        quote: None,
                                    },
                                },
                                right: ColumnRef {
                                    database: None,
                                    table: Some(
                                        Identifier {
                                            name: "b",
                                            quote: None,
                                        },
                                    ),
                                    column: Identifier {
                                        name: "a",
                                        quote: None,
                                    },
                                },
                            },
                        ),
                        left: Table {
                            database: None,
                            table: Identifier {
                                name: "a",
                                quote: None,
                            },
                            alias: None,
                        },
                        right: Table {
                            database: None,
                            table: Identifier {
                                name: "b",
                                quote: None,
                            },
                            alias: None,
                        },
                    },
                ),
                selection: None,
                group_by: [],
                having: None,
            },
        ),
        order_by: [],
        limit: [],
    },
)


---------- Input ----------
select * from a left outer join b on a.a = b.a;
---------- Output ---------
SELECT * FROM a LEFT OUTER JOIN b ON a.a = b.a
---------- AST ------------
Select(
    Query {
        body: Select(
            SelectStmt {
                distinct: false,
                select_list: [
                    QualifiedName(
                        [
                            Star,
                        ],
                    ),
                ],
                from: Join(
                    Join {
                        op: LeftOuter,
                        condition: On(
                            BinaryOp {
                                op: Eq,
                                left: ColumnRef {
                                    database: None,
                                    table: Some(
                                        Identifier {
                                            name: "a",
                                            quote: None,
                                        },
                                    ),
                                    column: Identifier {
                                        name: "a",
                                        quote: None,
                                    },
                                },
                                right: ColumnRef {
                                    database: None,
                                    table: Some(
                                        Identifier {
                                            name: "b",
                                            quote: None,
                                        },
                                    ),
                                    column: Identifier {
                                        name: "a",
                                        quote: None,
                                    },
                                },
                            },
                        ),
                        left: Table {
                            database: None,
                            table: Identifier {
                                name: "a",
                                quote: None,
                            },
                            alias: None,
                        },
                        right: Table {
                            database: None,
                            table: Identifier {
                                name: "b",
                                quote: None,
                            },
                            alias: None,
                        },
                    },
                ),
                selection: None,
                group_by: [],
                having: None,
            },
        ),
        order_by: [],
        limit: [],
    },
)


---------- Input ----------
select * from a right outer join b on a.a = b.a;
---------- Output ---------
SELECT * FROM a RIGHT OUTER JOIN b ON a.a = b.a
---------- AST ------------
Select(
    Query {
        body: Select(
            SelectStmt {
                distinct: false,
                select_list: [
                    QualifiedName(
                        [
                            Star,
                        ],
                    ),
                ],
                from: Join(
                    Join {
                        op: RightOuter,
                        condition: On(
                            BinaryOp {
                                op: Eq,
                                left: ColumnRef {
                                    database: None,
                                    table: Some(
                                        Identifier {
                                            name: "a",
                                            quote: None,
                                        },
                                    ),
                                    column: Identifier {
                                        name: "a",
                                        quote: None,
                                    },
                                },
                                right: ColumnRef {
                                    database: None,
                                    table: Some(
                                        Identifier {
                                            name: "b",
                                            quote: None,
                                        },
                                    ),
                                    column: Identifier {
                                        name: "a",
                                        quote: None,
                                    },
                                },
                            },
                        ),
                        left: Table {
                            database: None,
                            table: Identifier {
                                name: "a",
                                quote: None,
                            },
                            alias: None,
                        },
                        right: Table {
                            database: None,
                            table: Identifier {
                                name: "b",
                                quote: None,
                            },
                            alias: None,
                        },
                    },
                ),
                selection: None,
                group_by: [],
                having: None,
            },
        ),
        order_by: [],
        limit: [],
    },
)


---------- Input ----------
select * from a full outer join b on a.a = b.a;
---------- Output ---------
SELECT * FROM a FULL OUTER JOIN b ON a.a = b.a
---------- AST ------------
Select(
    Query {
        body: Select(
            SelectStmt {
                distinct: false,
                select_list: [
                    QualifiedName(
                        [
                            Star,
                        ],
                    ),
                ],
                from: Join(
                    Join {
                        op: FullOuter,
                        condition: On(
                            BinaryOp {
                                op: Eq,
                                left: ColumnRef {
                                    database: None,
                                    table: Some(
                                        Identifier {
                                            name: "a",
                                            quote: None,
                                        },
                                    ),
                                    column: Identifier {
                                        name: "a",
                                        quote: None,
                                    },
                                },
                                right: ColumnRef {
                                    database: None,
                                    table: Some(
                                        Identifier {
                                            name: "b",
                                            quote: None,
                                        },
                                    ),
                                    column: Identifier {
                                        name: "a",
                                        quote: None,
                                    },
                                },
                            },
                        ),
                        left: Table {
                            database: None,
                            table: Identifier {
                                name: "a",
                                quote: None,
                            },
                            alias: None,
                        },
                        right: Table {
                            database: None,
                            table: Identifier {
                                name: "b",
                                quote: None,
                            },
                            alias: None,
                        },
                    },
                ),
                selection: None,
                group_by: [],
                having: None,
            },
        ),
        order_by: [],
        limit: [],
    },
)


---------- Input ----------
select * from a inner join b on a.a = b.a;
---------- Output ---------
SELECT * FROM a INNER JOIN b ON a.a = b.a
---------- AST ------------
Select(
    Query {
        body: Select(
            SelectStmt {
                distinct: false,
                select_list: [
                    QualifiedName(
                        [
                            Star,
                        ],
                    ),
                ],
                from: Join(
                    Join {
                        op: Inner,
                        condition: On(
                            BinaryOp {
                                op: Eq,
                                left: ColumnRef {
                                    database: None,
                                    table: Some(
                                        Identifier {
                                            name: "a",
                                            quote: None,
                                        },
                                    ),
                                    column: Identifier {
                                        name: "a",
                                        quote: None,
                                    },
                                },
                                right: ColumnRef {
                                    database: None,
                                    table: Some(
                                        Identifier {
                                            name: "b",
                                            quote: None,
                                        },
                                    ),
                                    column: Identifier {
                                        name: "a",
                                        quote: None,
                                    },
                                },
                            },
                        ),
                        left: Table {
                            database: None,
                            table: Identifier {
                                name: "a",
                                quote: None,
                            },
                            alias: None,
                        },
                        right: Table {
                            database: None,
                            table: Identifier {
                                name: "b",
                                quote: None,
                            },
                            alias: None,
                        },
                    },
                ),
                selection: None,
                group_by: [],
                having: None,
            },
        ),
        order_by: [],
        limit: [],
    },
)


---------- Input ----------
select * from a left outer join b using(a);
---------- Output ---------
SELECT * FROM a LEFT OUTER JOIN b USING(a)
---------- AST ------------
Select(
    Query {
        body: Select(
            SelectStmt {
                distinct: false,
                select_list: [
                    QualifiedName(
                        [
                            Star,
                        ],
                    ),
                ],
                from: Join(
                    Join {
                        op: LeftOuter,
                        condition: Using(
                            [
                                Identifier {
                                    name: "a",
                                    quote: None,
                                },
                            ],
                        ),
                        left: Table {
                            database: None,
                            table: Identifier {
                                name: "a",
                                quote: None,
                            },
                            alias: None,
                        },
                        right: Table {
                            database: None,
                            table: Identifier {
                                name: "b",
                                quote: None,
                            },
                            alias: None,
                        },
                    },
                ),
                selection: None,
                group_by: [],
                having: None,
            },
        ),
        order_by: [],
        limit: [],
    },
)


---------- Input ----------
select * from a right outer join b using(a);
---------- Output ---------
SELECT * FROM a RIGHT OUTER JOIN b USING(a)
---------- AST ------------
Select(
    Query {
        body: Select(
            SelectStmt {
                distinct: false,
                select_list: [
                    QualifiedName(
                        [
                            Star,
                        ],
                    ),
                ],
                from: Join(
                    Join {
                        op: RightOuter,
                        condition: Using(
                            [
                                Identifier {
                                    name: "a",
                                    quote: None,
                                },
                            ],
                        ),
                        left: Table {
                            database: None,
                            table: Identifier {
                                name: "a",
                                quote: None,
                            },
                            alias: None,
                        },
                        right: Table {
                            database: None,
                            table: Identifier {
                                name: "b",
                                quote: None,
                            },
                            alias: None,
                        },
                    },
                ),
                selection: None,
                group_by: [],
                having: None,
            },
        ),
        order_by: [],
        limit: [],
    },
)


---------- Input ----------
select * from a full outer join b using(a);
---------- Output ---------
SELECT * FROM a FULL OUTER JOIN b USING(a)
---------- AST ------------
Select(
    Query {
        body: Select(
            SelectStmt {
                distinct: false,
                select_list: [
                    QualifiedName(
                        [
                            Star,
                        ],
                    ),
                ],
                from: Join(
                    Join {
                        op: FullOuter,
                        condition: Using(
                            [
                                Identifier {
                                    name: "a",
                                    quote: None,
                                },
                            ],
                        ),
                        left: Table {
                            database: None,
                            table: Identifier {
                                name: "a",
                                quote: None,
                            },
                            alias: None,
                        },
                        right: Table {
                            database: None,
                            table: Identifier {
                                name: "b",
                                quote: None,
                            },
                            alias: None,
                        },
                    },
                ),
                selection: None,
                group_by: [],
                having: None,
            },
        ),
        order_by: [],
        limit: [],
    },
)


---------- Input ----------
select * from a inner join b using(a);
---------- Output ---------
SELECT * FROM a INNER JOIN b USING(a)
---------- AST ------------
Select(
    Query {
        body: Select(
            SelectStmt {
                distinct: false,
                select_list: [
                    QualifiedName(
                        [
                            Star,
                        ],
                    ),
                ],
                from: Join(
                    Join {
                        op: Inner,
                        condition: Using(
                            [
                                Identifier {
                                    name: "a",
                                    quote: None,
                                },
                            ],
                        ),
                        left: Table {
                            database: None,
                            table: Identifier {
                                name: "a",
                                quote: None,
                            },
                            alias: None,
                        },
                        right: Table {
                            database: None,
                            table: Identifier {
                                name: "b",
                                quote: None,
                            },
                            alias: None,
                        },
                    },
                ),
                selection: None,
                group_by: [],
                having: None,
            },
        ),
        order_by: [],
        limit: [],
    },
)


